
==========================
|Mail Alert Simple Mailer|
==========================

Version: 1.07

Date: June, 2016

Author: MediLogic Adam £uszczewski

Contact: biuro@medilogic.pl



What is it?
-----------

Mail Alert Simple Mailer is a simple e-mail sending utility for IT administrators. It allows sending e-mail alert form monitoring software which can run EXE file when configured event occurs (eg. to high CPU or HDD temperature, RAID matrix failure, UPS on battery, etc.).

My main reason for writing this software was to handle events generated by Dell OpenManage Server Administrator (OMSA) and Windows Events, but it can be used with any software where e-mail alert feature is missing or incompatible with your mail server, but where you can run external program when specific event occurs.



How to start?
-------------

Before first run please edit configuration file MailAlert.ini to configure your specific settings.
Contact your mail server administrator for details such as: SMTP server, SMTP port number, whether your SMTP server supports SSL/TLS and on which port number.

It is recomended to run simple test after configuration: 

 MailAlert -t

When configuration is correct, you should receive a test e-mail.

You can specify only one choosen parameter, In such a case all required parameters will be loaded from INI file.



How to configure?
-----------------

MailAlert.ini file stores your mail account settings. This file has to be in the same diretory as MailAlert.exe.
Make sure that you have write permision to MailAlert.ini file.

The following parameters have to be configured at [CONFIGURATION] section:


* To - recipient e-mail address (To:). You can override this setting with commandline -r parameter. You can add more recipients using comma or semicolon separated e-mail addresses. Required parameter.


* From - sender e-mail address (From:). Required parameter.


* CC - carbon copy (Cc:) e-mail address(es). You can override this setting with commandline -c parameter. Use comma or semicolon to separate e-mail addresses for multiple recipients. Optional parameter.


* BCC - blind carbon copy (Bcc:) e-mail address(es). You can override this setting with commandline -u parameter. Use comma or semicolon to separate e-mail addresses for multiple recipients. Optional parameter.


* FullName - sender full name. Optional parameter.


* ReplyTo - return e-mail address (ReplyTo:). Optional parameter.


* SMTPServer - SMTP mail server address. It can be a domain name address. Required parameter.


* SMTPPort - SMTP mail server port number. Required parameter.


* Username - SMTP mail server username. Required parameter.


* Password - SMTP mail server password. Plaintext Password value will be converted to encrypted EncryptedPassword value after the first run of Mail Alert. In such a case plaintext Password will be removed from configuration file. Required parameter.


* EncryptedPassword - this parameter should never be edited by hand. It contains encrypted SMTP mail server password derived from Password parameter. If you need to change your SMTP mail server password, enter a new value in Password parameter and run Mail Alert to convert it to EncryptedPassword. This operation requires write access to INI file.


* EnableAutoTLS - if set to yes, then use StartTLS mode if remote server supports it. The IANA registered port number 25 for Simple Mail Transfer and port number 587 for Message Submission. Please contact you e-mail administrator for details. Allowed values are: yes or no. Required parameter.


* EnableSMTPS - if set to yes, then SSL/TLS mode is used from first contact to server, usualy using non-standard TCP port. Originally, the IANA registered port number 465 for SMTPS. SMTPS was revoked when StartTLS had been specified, but is still used by many mail servers till now. When EnableAutoTLS is set to yes then you should set EnableSMTPS to no. Please contact you e-mail administrator for details. Allowed values are: yes or no. Required parameter.


* Importance - e-mail importance level. Allowed values are: High or Normal or Low. Required parameter.


* VerboseMode -set Verbose Mode to see SMTP commands resylts. This parameter is useful for diagnostics. Allowed values are: yes or no. Optional parameter.


* PlaintextOnly - sent e-mail in plaintext or on HTML format. If you want to send e-mail in HTMT format set this parameter to no. If Charset is set to ISO-8859-2 then characters in TXT or HTML file are not converted from Windows CP1250 to ISO-8859-2 encoding. Allowed values are: yes or no. Required parameter.


* Charset - character encoding. If Charset is set to ISO-8859-2 then all input strings are converted form Windows CP1250 to ISO-8859-2 code page. Allowed values are: ISO-8859-1, ISO-8859-2 or UTF-8.



Special notes for Gmail users
-----------------------------

Use 16-digit App password instead of Gmail password if your Gmail account has enabled 2-Step Verification (also known as two-factor authentication).
Visit the following webpage to generate 16-digit App password:

https://security.google.com/settings/security/apppasswords



Syntax
------

Usage: MailAlert.exe <options>

<options>:

  -h                        Display this help.
  -t                        Send a test e-mail.
  -r "admin@example.org"    Set e-mail recipient address (To:) as a parameter.
  -s "Subject"              Set e-mail subject as a parameter.
  -b "Body text"            Set e-mail body as a parameter.
  -c "admin2@example.org"   Set e-mail Carbon Copy (Cc:) as a parameter.
  -u "boss@example.org"     Set e-mail Blind Carbon Copy (Bcc:) as a parameter.
  -b "@File"                Get e-mail body from a text File (HTML, TXT).
  -i "High|Normal|Low"      Set e-mail importance level as a parameter.
  -a "File"                 Attach a File as an e-mail attachment.
  -d                        Add local system date and time to message body.



Examples
--------


Send a test e-mail:
C:\> MailAlert -t


Send an e-mail with defined in commandline parameters subject and priority:
C:\> MailAlert -s "Mail subject" -p "High"


Send an e-mail with defined in commandline parameters recipient (recipient defined in INI file will be ignored), subject and body. Add local date and time on the bottom of e-mail body:
C:\> MailAlert -r "admin@example.org" -s "Mail subject" -b "Mail body." -d


Send an e-mail with defined in commandline parameters subject and body. Add local date and time on the bottom of e-mail body:
C:\> MailAlert -s "Mail subject" -b "Mail body." -d


Send an e-mail with defined in commandline parameters subject and C:\index.html file as a mail body (remember to set INI file parameter PlaintextOnly=no and correct Charset):
C:\> MailAlert -s "Mail subject" -b "@C:\index.html"


Send an e-mail with defined in commandline parameters subject, body and C:\file.zip attachment:
C:\> MailAlert -s "Mail subject" -b "Mail body." -a "C:\file.zip"




Exit codes
----------

The following Errorlevel exit codes can be used in your batch files.

0 - no errors, your message has been sent successfully

1 - configuration INI file not found

2 - incorrect e-mail To: address

3 - incorrect e-mail From: address

4 - SMTP Server address is empty

5 - SMTP Port number is empty

6 - E-mail Username is empty

7 - mail Importance value is not supported

8 - not supported charset

9 - attachment file has not been found

10 - your message can not be sent

11 - SMTP server Password is empty

12 - file libeay32.dll has not been found

13 - incorrect e-mail CC: address

14 - incorrect e-mail BCC: address

15 - incorrect e-mail ReplyTo: address

16 - syntax error


RFC
---

https://tools.ietf.org/html/rfc2476
https://tools.ietf.org/html/rfc6409
https://tools.ietf.org/html/rfc3207
