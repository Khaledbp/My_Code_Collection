2011-03-15.

This archive contains perl scripts and R scirpts and some example files.


1. The perl script "isoform_RefSeq_process.pl" will transform the RefSeq Annotation to the isoform annotation.

Usage of isoform_RefSeq_process.pl:
"./isoform_RefSeq_process.pl RefSeqAnnotation  Outputfile"

The RefSeqAnnotation file is downloaded from UCSC Genome Browers. The format is as follows
--------------------------------------------------------------------------------------------
#bin    name    chrom   strand  txStart txEnd   cdsStart        cdsEnd  exonCount       exonStarts      exonEnds        id      name2   cdsStartStat    cdsEndStat      exonFrames
0       NM_207014       chr1    -       67075871        67163158        67075923        67163102        10      67075871,67078739,67085754,67100417,67109640,67113051,67129424,67131499,67143471,67162932,      67076067,67078942,67085949,67100573,67109780,67113208,67129537,67131684,67143646,67163158,      0       WDR78   cmpl    cmpl    0,1,1,1,2,1,2,0,2,0,
0       NM_024763       chr1    -       67051160        67163158        67052400        67163102        17      67051160,67060631,67065090,67066082,67071855,67072261,67073896,67075980,67078739,67085754,67100417,67109640,67113051,67129424,67131499,67143471,67162932,       67052451,67060788,67065317,67066181,67071977,67072419,67074048,67076067,67078942,67085949,67100573,67109780,67113208,67129537,67131684,67143646,67163158,       0       WDR78   cmpl    cmpl    0,2,0,0,1,2,0,0,1,1,1,2,1,2,0,2,0,
1       NM_001042682    chr1    -       8335050 8406334 8337733 8346780 13      8335050,8338065,8338746,8340842,8342410,8342758,8344409,8345329,8346702,8347392,8348458,8405373,8406207,        8337767,8338246,8338893,8341563,8342633,8344137,8344523,8345491,8346902,8347485,8348621,8405454,8406334,        0       RERE    cmpl    cmpl    2,1,1,0,2,0,0,0,0,-1,-1,-1,-1,
1       NM_001042681    chr1    -       8335050 8800286 8337733 8638943 23      8335050,8338065,8338746,8340842,8342410,8342758,8344409,8345329,8346702,8347392,8348458,8405373,8448571,8477709,8480051,8491272,8523859,8539120,8540063,8597206,8606955,8638618,8799805,        8337767,8338246,8338893,8341563,8342633,8344137,8344523,8345491,8346902,8347485,8348621,8405454,8448670,8477809,8480176,8491321,8523964,8539217,8540169,8597332,8607026,8639087,8800286,        0       RERE    cmpl    cmpl    2,1,1,0,2,0,0,0,1,1,0,0,0,2,0,2,2,1,0,0,1,0,-1,

---------------------------------------------------------------------------------------------

2. The data file "Ref_processed" is an example of the processed annotation by isoform_RefSeq_process.pl


3. The perl script "isoform_RefSeq.pl" will count the shortreads of exons of the genes.

Usage of isoform_RefSeq_process.pl:
"./isoform_RefSeq.pl ISOFORM_Annotation SAM_FILE  Outputfile Shift"

The ISOFORM_Annotation is from the output of isoform_RefSeq_process.pl, such as the "Ref_processed" file.
SAM_FILE is the mapping result file generated by mapping tools such as Bowtie. It is in SAM format (see http://samtools.sourceforge.net/). 
Outputfile: The file name that you want to save the results; it will be the input file for  "r-RefSeq-isoform.R".
Shift: the mapped read position by mapping tools is the left most position of the reads; to consider the short-read length, you can use "Shift" (range from 0 to ShortReadLength) to shift the mapped position. In our study, we shift to the center of the shortreads.


4. The data file "liver_isoform_3"  is an example of output file by  isoform_RefSeq.pl. It contains all genes with 3 isoforms and the exon short-reads count in the live tissue of Dataset I in our paper.

5. The R script  "r-RefSeq-isoform.R" will caculate the relative expression levels of isoforms for each gene.
The input file is from the output by "isoform_RefSeq.pl", see "liver_isoform_3" for example. 


-------------------------------------------------------------------------------------
Contact inforamtion
For more information, addtional data and scripts (such as the simulation and plot codes), bug reports and comments, please contact Lin Wan via linwan -at- usc -dot- edu. 






